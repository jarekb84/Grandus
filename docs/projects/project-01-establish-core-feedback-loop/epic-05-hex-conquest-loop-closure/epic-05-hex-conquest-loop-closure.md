# Epic: 05-Hex-Conquest-Loop-Closure

## Epic Goal

*   Implement the Wave 10 clear condition within an `Expand Combat` run as the trigger for conquering the targeted hex. Update the Territory View upon success to visually reflect the conquered hex status and reveal its associated resource node(s), closing the loop.

## Status

*   Proposed

## Linked Project

*   **Project File:** [`project-01-establish-core-feedback-loop.md`](../project-01-establish-core-feedback-loop.md)
*   **Overall Project Goal:** Implement the minimum viable gameplay loop connecting the core views: Gather Stone in Territory View, initiate Expand Combat, earn persistent Coins from Combat success (e.g., clearing Wave 1), spend Coins in a minimal Management View to unlock basic Stone-to-Pebble crafting, use crafted Pebbles to conquer the first Hex (e.g., clear Wave 10), and have the conquered Hex reveal a better/new Stone node.

## Scope & Key Features (for this Epic)

*   Modify the Combat Scene (PhaserJS) Wave logic: Continue spawning enemies for subsequent waves (e.g., Wave 2, 3... up to 10). Define basic scaling or enemy counts for these waves (exact balancing deferred).
*   Implement a win condition for `Expand Combat`: Successfully clearing Wave 10.
*   Upon achieving the win condition (clearing Wave 10):
    *   Signal success back to the core game state/Territory View, including the identity of the conquered hex (the target from Epic 1).
    *   Update the core game state to mark the target hex as "Controlled".
*   Modify the Territory View (PhaserJS):
    *   Read the "Controlled" status for hexes from the core game state.
    *   Visually update conquered hexes (e.g., change color, add overlay).
    *   Upon conquest, reveal/spawn the associated resource node(s) within that hex (e.g., a new Stone node, potentially with different properties than the home node).
    *   Ensure revealed nodes are targetable for gathering actions.

## Out of Scope (for this Epic)

*   Implementing `Enhance Hex` combat mode.
*   Complex resource node properties (beyond basic reveal).
*   Detailed balancing of Waves 2-10.
*   Advanced visual effects for conquest or node reveal.
*   Gathering logic for the newly revealed nodes (assumes existing gather logic works once node is present).

## Embedded Project Context

*   **Relevant Project Sections:**
    *   From Project Goal: ...use crafted Pebbles to conquer the first Hex (e.g., clear Wave 10), and have the conquered Hex reveal a better/new Stone node.
    *   From Key Systems: Combat Scene (PhaserJS): ...Hex conquest trigger (e.g., Wave 10 clear). Core Game State: ...conquered Hex status, node availability/state.
    *   From Source Context (Combat Scene): Territory Conquest (`Expand`): Successfully completing an `Expand` run... changes the target hex's status to "Controlled" on the Territory map, revealing its nodes...
    *   From Source Context (MVP Refined): Core Loop Link: Successfully completing (`Expand`) the Combat run... changes the target hex status to "Controlled" in the Territory View and reveals its Stone node(s).
    *   From User Context: Clear Wave 10 -> Conquer Hex -> Unlock better Stone node... I need to clear 10 waves, like only clear one... to conquer the hexes around me... I need to be able to kill a hundred enemies... And the reason I want to conquer this cell is... it unlocks another resource... maybe there's another stone patch there...

## Notes / Design Links / Dependencies (Optional)

*   Depends on Epic 4 for Pebble ammo usage needed to clear multiple waves.
*   Depends on Epic 1 for targeted hex information.
*   Requires Combat Scene wave progression logic.
*   Requires Territory View logic for displaying hex states and spawning/revealing nodes.
*   Requires core game state to store hex control status and node information.

---
*Generated by Roo `project-epic-generator` mode.*